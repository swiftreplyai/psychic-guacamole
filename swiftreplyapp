import streamlit as st
import openai

st.title("SwiftReply: Automatic Email Response Generation")
st.sidebar.header("Instructions")
st.sidebar.info(
    '''This is a web application that uses natural language processing to analyze 
       an email and draft a response email that addresses the sender's concerns or 
       questions, provides additional information or clarification, and maintains a 
       professional tone. Please enter the body of the email and click "Generate Response" 
       to receive the response email.
       '''
    )

# Set the model engine and your OpenAI API key
model_engine = "text-davinci-003"
openai.api_key = "YOUR-KEY-HERE"

def generate_response_email(email_body, insight):
    '''Generates a response email based on the input email'''

    # Use the OpenAI API to generate a response email
    response = openai.Completion.create(
        engine=model_engine,
        prompt=f"{insight}\n\n{email_body}",
        max_tokens=1024,
        n=1,
        stop=None,
        temperature=0.9,
        top_p = 0.9
    )

    response_text = response.choices[0].text.strip()
    response_email = f"From: Customer Service Team\n\n{response_text}"
    return response_email

def main():
    '''Gets the user input and generates and displays the response email'''

    # Get user input for the email body
    email_body = st.text_area("Enter email body:")

    # Get user input for the insight
    insight = st.text_input("Enter insight:")

    # Generate and display the response email
    if st.button("Generate Response"):
        response_email = generate_response_email(email_body, insight)
        st.write(response_email)

# Call the main function
if __name__ == '__main__':
    main()

